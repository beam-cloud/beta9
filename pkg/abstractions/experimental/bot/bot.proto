syntax = "proto3";

option go_package = "github.com/beam-cloud/beta9/proto";

package bot;

service BotService {
  rpc StartBotServe(StartBotServeRequest)
      returns (stream StartBotServeResponse) {}
  rpc StopBotServe(StopBotServeRequest) returns (StopBotServeResponse) {}
  rpc BotServeKeepAlive(BotServeKeepAliveRequest)
      returns (BotServeKeepAliveResponse) {}
  rpc SendBotMessage(SendBotMessageRequest) returns (SendBotMessageResponse) {}
  rpc PopBotMarker(PopBotMarkerRequest) returns (PopBotMarkerResponse) {}
  rpc PushBotMarker(PushBotMarkerRequest) returns (PushBotMarkerResponse) {}
}

message StartBotServeRequest {
  string stub_id = 1;
  int32 timeout = 2;
}

message StartBotServeResponse {
  string output = 1;
  bool done = 2;
  int32 exit_code = 3;
}

message StopBotServeRequest { string stub_id = 1; }
message StopBotServeResponse { bool ok = 1; }

message BotServeKeepAliveRequest {
  string stub_id = 1;
  int32 timeout = 2;
}
message BotServeKeepAliveResponse { bool ok = 1; }

message SendBotMessageRequest {
  string stub_id = 1;
  string message = 2;
  string session_id = 3;
}

message SendBotMessageResponse { bool ok = 1; }

message PopBotMarkerRequest {
  string stub_id = 1;
  string session_id = 2;
  string location_name = 3;
}

message PopBotMarkerResponse {
  bool ok = 1;
  bytes marker = 2;
}

message PushBotMarkerRequest {
  string stub_id = 1;
  string session_id = 2;
  string location_name = 3;
  bytes marker = 4;
}

message PushBotMarkerResponse { bool ok = 1; }
